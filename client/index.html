<!DOCTYPE html>
<html ng-app='utopia'>
	<head>
		<meta name="description" content="Agile software project management tool" />
		<meta name="keywords" content="Agile made easy" />
		<meta name="author" content="metatags generator">
		<meta name="robots" content="index, follow" />
		<meta name="revisit-after" content="1 days" />
		<meta http-equiv="Cache-control" content="public"/>

		<link rel="stylesheet" type="text/css" href="css\jquery-ui-1.10.3.custom.min.css" />
		<link rel="stylesheet" type="text/css" href="css\bootstrap.css" />
		<link rel="stylesheet" type="text/css" href="css\bootstrap-responsive.css" />
		<link rel="stylesheet" type="text/css" href="css\chosen.css" />
		<link rel="stylesheet" type="text/css" href="css\timeline.css" />
		<link rel="stylesheet" type="text/css" href="css\site.css">
		<title>Utopia</title>
	</head>
	<body>
		 <!-- Nav bar -->
		<div class="navbar navbar-inverse">
	      <div class="navbar-inner">
	        <div class="container">
	          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
	            <span class="icon-bar"></span>
	            <span class="icon-bar"></span>
	            <span class="icon-bar"></span>
	          </button>
	          <a class="brand" href="#/">Utopia</a>
	          <div class="nav-collapse collapse menu-bar">
	            <ul class="nav">
	              <li class="" ng-repeat='menu in menues'>
	                <a href="{{menu.href}}">{{menu.text}}</a>
	              </li>
	            </ul>
	          </div>
	          <span class="custom-flash alert {{flashClass}}" ng-bind="flashMessage" ng-show='flashShow' ng-animate="'animate'"></span>
	        </div>
	      </div>
    	</div>
    	<!-- Main body container -->
		<div class="container">
			<div ng-view>
			</div>
		</div>

		<footer class='text-center footer'>Chinmay Kulkarni production 2013 &copy</footer>

	    <!-- ng-templates -->
		<script type="text/ng-template" id="login">
		<!-- Login View -->
	    	<div class='row-fluid'>
				<div class='span9'>
				<!-- Login Carousel -->
				<div id="myCarousel" class="carousel slide">
				  <ol class="carousel-indicators">
				    <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
				    <li data-target="#myCarousel" data-slide-to="1"></li>
				    <li data-target="#myCarousel" data-slide-to="2"></li>
				    <li data-target="#myCarousel" data-slide-to="3"></li>
				    <li data-target="#myCarousel" data-slide-to="4"></li>
				  </ol>
				  <!-- Carousel items -->
				  <div class="carousel-inner">
				    <div class="active item">
				    	<h1>Agile project management</h1>
				    	<span>Simple yet powerful</span>
				    </div>
				    <div class="item">
				    	<h1>Interactive dashboards</h1>
				    	<span>Know the current state of your project</span>
				    </div>
				    <div class="item">
				    	<h1>Beautiful timeline view</h1>
				    	<span>Get to know who's working on what</span>
				    </div>
				     <div class="item">
				    	<h1>Emphasis on planning and testing</h1>
				    	<span>It's important</span>
				    </div>
				     <div class="item">
				    	<h1>Customizable whiteboards</h1>
				    	<span>Make Utopia your own!</span>
				    </div>
				  </div>
				  <!-- Carousel nav -->
				  <a class="carousel-control left" href="#myCarousel" data-slide="prev">&lsaquo;</a>
				  <a class="carousel-control right" href="#myCarousel" data-slide="next">&rsaquo;</a>
				</div>
				</div>
				<!-- Login form -->
				<form class="span3 login-form">
				  <div class="control-group">
				    <label class="control-label" for="inputEmail">Email</label>
				    <div class="controls">
				      <input type="email" id="username" placeholder="Email" ng-model='username' required>
				    </div>
				  </div>
				  <div class="control-group">
				    <label class="control-label" for="inputPassword">Password</label>
				    <div class="controls">
				      <input type="password" id="password" placeholder="Password" ng-model='password' required>
				    </div>
				  </div>
				  <div class="control-group">
				    <div class="controls">
				      <label class="checkbox">
				        <input type="checkbox"> Remember me
				      </label>
				      <input type="submit" class="btn" ng-click='submit()'>Sign in</input>
				    </div>
				  </div>
				</form>
			</div>
	  	</script>

		<script type="text/ng-template" id="logout">
		<!-- Logout View -->
	    	<div class='row-fluid'>
	    		<h1>You have successfully logged out.</h1>
	    		<span>Click <a href='#/login'>here</a> to login.</span>
			</div>
	  	</script>

	  	<script type="text/ng-template" id="projects">
		<!-- Landing View -->
	    	<div class='row-fluid'>
				<h1>My projects</h1>
				<div class='project' ng-repeat="project in projects" ng-click='load_project()'>
					<h3>{{project.title}}</h3>
					<p>{{project.description}}</p>
				</div>
			</div>
	  	</script>

	  	<script type="text/ng-template" id="under-construction">
		<!-- under-contruction View -->
	    	<div class='row-fluid'>
				<h1>This page is under construction</h1>
			</div>
	  	</script>

	  	<script type="text/ng-template" id="white-board">
		<!-- whiteboard View -->
	    	<div class='row-fluid'>
				<ul class="nav nav-pills">
					<li><a href='#/projects/{{project_id}}/dashboard'>Dashboard</a></li>
					<li class='active'><a href='#/projects/{{project_id}}/white-board'>Whiteboard</a></li>
					<li><a href='#/projects/{{project_id}}/timeline'>Timeline</a></li>
					<li><a href='#/projects/{{project_id}}/planning'>Planning</a></li>
				</ul>
			</div>
			<div class="row-fluid" >
	  			<div class="span4" id='side-pane'>
	  				<legend class='input-prepend'>
  						 <span class="add-on">My workitems</span>
  						 <input type="text" ng-model='query' placeholder='Search...'>
  						 <span class="add-on">
  						 	<i class="icon-search hover-hand" ng-click='search()'></i>
  						 </span>
  						 <span class="add-on" ng-click="predicate = 'importance'; reverse=!reverse">
  						 	<i class="hover-hand icon-signal" title='Sort by priority'></i>
  						 </span>
  					</legend>
	  				<ul class='unstyled workitems' resize ng-style='style()' id='internal-view'>
		  				<li ng-repeat='wk in workitems | filter:query | orderBy:predicate:reverse' class='workitem' ng-click='select()' ng-class="{true : 'selected', false : ''}[wk.id==swkitm.id]" ng-animate=" 'animate' ">
	  					<span class="badge pull-right" ng-class="{0:'badge-important', 1: 'badge-success', 2: 'badge-warning'}[wk.importance]" title='Priority'>
	  						{{wk.importance}}</span>
	  					<span><b>{{wk.title}}</b></span>
	  					<p>
	  						<span class='text-info '>{{getType(wk.type)}}</span>
	  						<span class='muted capitalize'>{{getState(wk.state)}}</span>
	  						<small class='pull-right'><i>Last updated: {{ago(wk.last_updated)}}</i></small>
  						</p>
		  				</li>
	  				</ul>
	  				</div>
	  			<div class="span8" id='details-pane'>
	  				<legend class='input-prepend'>
	  					<h4>Details- <small>
	  						<abbr title='{{getBreakDown()}}'><b>{{workitems.length}}</b></abbr> to go !
	  					</small>
	  					<ul class="pull-right" ng-show='swkitm'>
	  						<li class="btn btn-danger btn-small no-decoration" ng-click='deleteWorkitem()'>Delete</li>
	  						<li class="btn btn-success btn-small no-decoration" ng-click='saveWorkitem()'>Save</li>
	  					</ul>
	  					</h4>
	  				</legend>
	  				<div class='row-fluid' ng-show='swkitm'>
		  				<table class='table-condensed span6' resize ng-style='style()'>
		  					<tr class='hover-hand'>
		  						<td><small>ID</small></td>
		  						<td><code><span ng-bind="swkitm.id"></span></code></td>
		  					</tr>
		  					<tr>
		  						<td>Title</td>
		  						<td><input type='text' ng-model='swkitm.title'/></td>
		  					</tr>
		  					<tr>
		  						<td>Description</td>
		  						<td><textarea type='text' ng-model='swkitm.description'></textarea></td>
		  					</tr>
		  					
		  					<tr>
		  						<td>Importance</td>
		  						<td>
			  						<span class='badge hover-hand' ng-class="{true:'badge-important', false:''}[0==swkitm.importance]" ng-click='setImportance(0)'>0</span>
			  						<span class='badge hover-hand' ng-class="{true:'badge-success', false:''}[1==swkitm.importance]" ng-click='setImportance(1)'>1</span>
			  						<span class='badge hover-hand' ng-class="{true:'badge-warning', false:''}[2==swkitm.importance]" ng-click='setImportance(2)'>2</span>
		  						</td>
		  					</tr>
		  					<tr>
		  						<td>Story points</td>
		  						<td>
			  						<span class='badge hover-hand' ng-class="{true:'badge-info', false:''}[0==swkitm.story_points]" ng-click='setStoryPoints(0)'>!</span>
			  						<span class='badge hover-hand' ng-class="{true:'badge-info', false:''}[1==swkitm.story_points]" ng-click='setStoryPoints(1)'>!!</span>
			  						<span class='badge hover-hand' ng-class="{true:'badge-info', false:''}[2==swkitm.story_points]" ng-click='setStoryPoints(2)'>!!!</span>
		  						</td>
		  					</tr>
		  					<tr>
		  						<td>Type</td>
		  						<td>
		  							<select class='input-medium'
		  							   chosen ng-model="swkitm.type"
								       ng-options="t.id as t.title for t in types"
								       ng-change='updateStates()'>
									</select>
		  						</td>
		  					</tr>
		  					<tr>
		  						<td>State</td>
		  						<td>
		  							<select class='input-medium'
		  							   chosen ng-model="swkitm.state"
								       ng-options="t.id as t.title for t in states">
									</select>
		  						</td>
		  					</tr>
		  					<tr>
		  						<td>Assigned to</td>
		  						<td>
		  							<select class='input-medium'
		  							   chosen ng-model="swkitm.assigned_to"
								       ng-options="t.user_id as t.display_name for t in users">
									</select>
		  						</td>
		  					</tr>
		  					<tr>
		  						<td>Created by</td>
		  						<td>
		  							<select class='input-medium'
		  							   chosen ng-model="swkitm.created_by"
								       ng-options="t.user_id as t.display_name for t in users">
									</select>
		  						</td>
		  					</tr>
		  					<tr>
		  						<td>Planned for</td>
		  						<td><a ng-model='swkitm.planned_for'>{{getSprint(swkitm.planned_for)}}</a></td>
		  					</tr>
		  					<tr>
		  						<td>Created</td>
		  						<td><span type='text'>{{format(swkitm.created_date)}}</span></td>
		  					</tr>
		  					<tr>
		  						<td>Last updated</td>
		  						<td><span ng-model='swkitm.last_updated'>{{ago(swkitm.last_updated)}}</span></td>
		  					</tr>
		  				</table>
		  				<div class="span6" resize ng-style='style()'>
		  					<h6 class='hover-hand' ng-click='tasksCollapse = !tasksCollapse'>Tasks</h6>
		  					<ul class="unstyled" collapse='tasksCollapse'>
							    <li class='hover-parent' ng-repeat="task in tasks" ng-animate="'animate'">
						    	<label class='checkbox' >
							      <input type="checkbox" ng-click='toggleTask()' ng-model="task.done" ng-checked="task.done==1">
							      <span class="done-{{task.done}}" ng-click='toggleTask()'>{{task.task}}</span>
							      <button class="close hover-child" ng-click='deleteTask()'>x</button>
						      	</label>
							    </li>
							    <li>
							    <form ng-submit="addTask()">	
								    <input type="text" ng-model="newTask"  size="30"
								           placeholder="add some tasks!">
								    <input class="btn input-append btn-mini" type="submit" value="Add">
						  		</form>
							    </li>
							</ul>
						  	
		  					<h6 class='hover-hand' ng-click='activityCollapse = !activityCollapse'>Activity</h6>
		  					<ul class='unstyled' collapse='activityCollapse'>
		  					<li>
			  				<blockquote class="comments hover-parent" ng-repeat='comment in comments' ng-animate=" 'animate' ">
			  					<button class='close pull-right hover-hand hover-child' type='button' ng-show='comment.created_by == currentUser' ng-click='deleteComment($index)'>x</button>
		  						<p><pre>{{comment.comment_body}}</pre></p> 
			  					<small>by {{getUser(comment.created_by)}}, {{ago(comment.created_at)}}</small> 
			  				</blockquote>
			  				</li>
			  				<li>
			  				<form ng-submit='addComment()'>
			  					<textarea ng-model='newComment'></textarea>
			  					<input type='submit' class="btn btn-mini" value='Add'></input>
			  				</form>
			  				</li>
			  				</ul>
		  				</div>
					</div>
					<div ng-show='!swkitm'>
						<blockquote class='text-center'>
  						<h2><small>Select a workitem from pane</small></h2>
						</blockquote>
					</div>
	  			</div>
	  		</div>
	  	</script>

		<script type="text/ng-template" id="timeline">
		<!-- timeline View -->
	    	<div class='row-fluid'>
				<ul class="nav nav-pills">
					<li><a href='#/projects/{{project_id}}/dashboard'>Dashboard</a></li>
					<li><a href='#/projects/{{project_id}}/white-board'>Whiteboard</a></li>
					<li class='active'><a href='#/projects/{{project_id}}/timeline'>Timeline</a></li>
					<li><a href='#/projects/{{project_id}}/planning'>Planning</a></li>
				</ul>
			</div>
			<div class="row-fluid text-center" resize ng-style='style()' id='internal-view'>
				<div class='span3'>
					<div ut-filter-pane></div>
				</div>
				<div class="span9">
				<ul class="work-timeline" ng-repeat='l in logs'>
					<div class='year' ng-click='collapseDate = ! collapseDate'>
							{{formatDate(l.year.last_updated, true)}}
					</div>
					<div collapse="collapseDate">
						<li class="entry" ng-repeat='log in l.entries' ng-switch='log.log_type'>
							<div ng-switch-when="workitem_log">
								<div class='header'>
								<i class="icon-edit"></i> {{getUser(log.user_id)}}
									<small title='{{formatDate(log.last_updated)}}' class='pull-right'>{{ago(log.timestamp)}}</small>
								</div>
								<span class="muted">changed </span>{{log.action}} 
								<span class="muted">from </span>{{getValue(log.old_value, log.action)}}
								<span class="muted">to </span>{{getValue(log.new_value, log.action)}} 
								<div>
									for workitem <span class='hover-hand' ut-wk-popover="{{log.workitem_id}}">#{{log.workitem_id}}</span>
								</div>
							</div>
							<div ng-switch-when="task_log">
								<div class='header'>
									<i class="icon-ok"></i> {{getUser(log.user_id)}}
									<small title='{{formatDate(log.last_updated)}}' class='pull-right'>{{ago(log.last_updated)}}</small>
								</div>
								<span class="muted">completed task</span> {{log.task}}
								<div>
									for workitem <a href="" ut-wk-popover=""{{log.workitem_id}}"">#{{log.workitem_id}}</a>
								</div>
							</div>
							<div ng-switch-when="comments">
								<div class='header'>
								<i class="icon-comment"></i> {{getUser(log.created_by)}}
									<small title='{{log.last_updated}}' class='pull-right'>{{ago(log.last_updated)}}</small>
								</div>
								<span class="muted">commented</span> {{log.comment_body}}
								<div>
									on workitem <a href="">#{{log.workitem_id}}</a>
								</div>
							</div>
						</li>
					</div>
				</ul>
				<p></p>
				<div class="alert alert-info"><strong class='hover-hand'>Load more</strong></div>
				</div>
			</div>
	  	</script>
		
	  	<script type="text/ng-template" id="workitem-details">
		<!-- workitem details popover -->
	  		<span>
	  		{{content}}
	  		<div class="popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">
			  <div class="arrow"></div>
			  <div class="popover-inner">
			      <h3 class="popover-title" ng-bind="title" ng-show="title"></h3>
			      <div class="popover-content" ng-bind="content">
	  				<h1>Hello World</h1>
			      </div>
			  </div>
			</div>
			</span>
	  	</script>

	  	<script id="filter-pane" type="text/ng-template">
		<!-- filter pane -->
			<div class="well text-left side-nav affix">
				<legend>Filter</legend>
				<strong>By workitem ID</strong>
    			<label>
					<input type="text" ng-model='workitem_ids'/>
				</label>
				<div><strong>By users</strong></div>
				<select chosen
					multiple='true'
					ng-model='selectedUsers'
					ng-options='t.user_id as t.display_name for t in users'/>
    			<div>
    				<strong>By date</strong>
    			</div>
    			<label>
    				<div>Start</div>
					<input type="date" ng-model='from' />
				</label>
    			<label>
    				<div>End</div>
					<input type="date" ng-model='to' />
				</label>
				<div><strong>Group by</strong></div>
				<label class="radio inline">
				  <input type="radio" name="group-radios" value="User" checked>
				  User
				</label>
			  	<label class="radio inline">
				  <input type="radio" name="group-radios" value="Workitem">
				  Workitem
				</label>
    			<div>
    				<input type='button' class="btn btn-medium pull-right" ng-click='applyFilter()' value='Apply' />
    			</div>
    			</form>
			</div>
	  	</script>

    	<script type="text/javascript" src="scripts\libs\jquery-2.0.min.js"></script>
    	<script type="text/javascript" src="scripts\libs\jquery-ui-1.10.3.custom.min.js"></script>
    	<script type="text/javascript" src="scripts\libs\bootstrap.min.js"></script>
    	<script type="text/javascript" src="scripts\libs\angular.min.js"></script>
    	<script type="text/javascript" src="scripts\libs\angular-resource.min.js"></script>
    	<script type="text/javascript" src="scripts\libs\angular-ui-bootstrap.min.js"></script>
    	<script type="text/javascript" src="scripts\libs\moment.min.js"></script>
    	<script type="text/javascript" src="scripts\libs\chosen.jquery.js"></script>
    	<script type="text/javascript" src="scripts\libs\chosen.js"></script>
    	<script type="text/javascript" src="scripts\app.js"></script>
    	<script type="text/javascript" src="scripts\services.js"></script>
    	<script type="text/javascript" src="scripts\utils.js"></script>
    	<script type="text/javascript" src="scripts\controllers.js"></script>
    	<script type="text/javascript" src="scripts\directives.js"></script>
	</body>
</html>
